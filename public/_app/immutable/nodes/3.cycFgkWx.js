import"../chunks/CWj6FrbW.js";import"../chunks/BT41tpRH.js";import{q as D,p as T,D as B,a as F,F as w,G as x,H as P,e as i,I as S,J as p}from"../chunks/BlGIzUQe.js";import{e as G,s as H}from"../chunks/CtmX9svw.js";import{t as J,a as z}from"../chunks/BOO1MpKp.js";import{i as C}from"../chunks/Bfj3dHs4.js";import{o as K}from"../chunks/Cxrypqd2.js";import{s as _}from"../chunks/2fp1sLlO.js";function Q(a,u){return a==null?null:String(a)}function X(a,u,d,n){var o=a.__style;if(D||o!==u){var r=Q(u);(!D||r!==a.getAttribute("style"))&&(r==null?a.removeAttribute("style"):a.style.cssText=r),a.__style=u}return n}var U=J('<div><button class="svelte-18awjjh"> </button> <div class="controller svelte-18awjjh"><div id="left-stick" class="stick svelte-18awjjh" title="Left Stick (Throttle / Yaw)"><div class="stick-knob"></div></div> <div id="right-stick" class="stick svelte-18awjjh" title="Right Stick (Pitch / Roll)"><div class="stick-knob"></div></div></div></div>');function lt(a,u){T(u,!1);let d=S(!1),n=S({x:0,y:0}),o=S({x:0,y:0}),r=null,y=null;const v=(f,t=1)=>{i(d)&&_.emit("move",{direction:f,speed:t})},$=()=>{p(d,!i(d)),_.emit("power",{state:i(d)}),i(d)||(clearInterval(r),clearInterval(y))},j=(f,t,s)=>{const e=Math.sqrt(t*t+s*s),m=75,h=Math.atan2(s,t),l=Math.min(e,m),c=Math.cos(h)*l,g=Math.sin(h)*l;f==="left"?p(n,{x:c,y:g}):f==="right"&&p(o,{x:c,y:g})},k=(f,t,s)=>{const e=Math.min(Math.sqrt(t*t+s*s)/75,1);f==="left"?(s<-10?v("up",e):s>10&&v("down",e),t<-10?v("rotateLeft",e):t>10&&v("rotateRight",e)):f==="right"&&(s<-10?v("forward",e):s>10&&v("backward",e),t<-10?v("left",e):t>10&&v("right",e))},L=(f,t)=>{const s=document.getElementById(f);let e=!1,m,h;s.addEventListener("mousedown",l=>{e=!0,m=l.clientX,h=l.clientY,t==="left"?r=setInterval(()=>k("left",i(n).x,i(n).y),100):y=setInterval(()=>k("right",i(o).x,i(o).y),100)}),window.addEventListener("mousemove",l=>{if(e){const c=l.clientX-m,g=l.clientY-h;j(t,c,g)}}),window.addEventListener("mouseup",()=>{e=!1,t==="left"?(p(n,{x:0,y:0}),clearInterval(r)):(p(o,{x:0,y:0}),clearInterval(y))}),s.addEventListener("touchstart",l=>{e=!0;const c=l.touches[0];m=c.clientX,h=c.clientY,t==="left"?r=setInterval(()=>k("left",i(n).x,i(n).y),100):y=setInterval(()=>k("right",i(o).x,i(o).y),100)}),s.addEventListener("touchmove",l=>{if(e){const c=l.touches[0],g=c.clientX-m,A=c.clientY-h;j(t,g,A)}}),s.addEventListener("touchend",()=>{e=!1,t==="left"?(p(n,{x:0,y:0}),clearInterval(r)):(p(o,{x:0,y:0}),clearInterval(y))})};K(()=>{L("left-stick","left"),L("right-stick","right")}),_.on("connect",()=>console.log("Socket connected")),_.on("disconnect",()=>console.log("Socket disconnected")),C();var M=U(),I=w(M),q=w(I);x(I);var E=P(I,2),b=w(E),O=w(b);x(b);var Y=P(b,2),R=w(Y);x(Y),x(E),x(M),B(()=>{H(q,`Power ${(i(d)?"Off":"On")??""}`),X(O,`left: calc(50% + ${i(n).x??""}px); top: calc(50% + ${i(n).y??""}px);`),X(R,`left: calc(50% + ${i(o).x??""}px); top: calc(50% + ${i(o).y??""}px);`)}),G("click",I,$),z(a,M),F()}export{lt as component};
