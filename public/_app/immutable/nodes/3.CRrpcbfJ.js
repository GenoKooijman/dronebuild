import"../chunks/CWj6FrbW.js";import"../chunks/DPzekCTE.js";import{q as A,p as z,D as C,a as K,F as k,G as y,H as T,g as n,I as Y,J as m}from"../chunks/K-7tmPTi.js";import{e as Q,s as U}from"../chunks/Ge9OkFrN.js";import{t as V,a as W}from"../chunks/OZ0zpi63.js";import{b as Z}from"../chunks/Bf_liN7s.js";import{i as N}from"../chunks/DF1DFF_U.js";import{o as tt}from"../chunks/BYTDAOBe.js";import{s as M}from"../chunks/DboeA1jd.js";function et(r,d){return r==null?null:String(r)}function B(r,d,w,s){var p=r.__style;if(A||p!==d){var o=et(d);(!A||o!==r.getAttribute("style"))&&(o==null?r.removeAttribute("style"):r.style.cssText=o),r.__style=d}return s}var lt=V('<div><button class="svelte-cb6c1l"> </button> <div class="controller svelte-cb6c1l"><div id="left-stick" class="stick svelte-cb6c1l" title="Left Stick (Throttle / Yaw)"><div class="stick-knob svelte-cb6c1l"></div></div> <div id="right-stick" class="stick svelte-cb6c1l" title="Right Stick (Pitch / Roll)"><div class="stick-knob svelte-cb6c1l"></div></div></div></div>');function ut(r,d){z(d,!1);const w=!0;let s=Y(!1),p=Y({x:0,y:0}),o=Y({x:0,y:0}),_=0,x=0,S=0,D=0,a=null,f=null;const v=(l,t=1)=>{n(s)&&M.emit("move",{direction:l,speed:t})},F=()=>(m(s,!n(s)),M.emit("power",{state:n(s)}),n(s)||(clearInterval(a),clearInterval(f),a=null,f=null),n(s)),P=(l,t,e)=>{if(!n(s))return;const u=Math.sqrt(t*t+e*e),g=75,h=Math.atan2(e,t),i=Math.min(u,g),c=Math.cos(h)*i,b=Math.sin(h)*i;l==="left"?(m(p,{x:c,y:b}),_=t,x=e):l==="right"&&(m(o,{x:c,y:b}),S=t,D=e)},X=(l,t)=>{if(!n(s))return;const e=Math.min(Math.sqrt(l*l+t*t)/75,1);t<-10?v("up",e):t>10&&v("down",e),l<-10?v("rotateLeft",e):l>10&&v("rotateRight",e)},q=(l,t)=>{if(!n(s))return;const e=Math.min(Math.sqrt(l*l+t*t)/75,1);t<-10?v("forward",e):t>10&&v("backward",e),l<-10?v("left",e):l>10&&v("right",e)},R=(l,t)=>{const e=document.getElementById(l);let u=!1,g,h;e.addEventListener("mousedown",i=>{u=!0,g=i.clientX,h=i.clientY,t==="left"?a=setInterval(()=>X(_,x),100):f=setInterval(()=>q(S,D),100)}),window.addEventListener("mousemove",i=>{if(!u)return;const c=i.clientX-g,b=i.clientY-h;P(t,c,b)}),window.addEventListener("mouseup",()=>{u=!1,t==="left"?(m(p,{x:0,y:0}),clearInterval(a),a=null):(m(o,{x:0,y:0}),clearInterval(f),f=null)}),e.addEventListener("touchstart",i=>{u=!0;const c=i.touches[0];g=c.clientX,h=c.clientY,t==="left"?a=setInterval(()=>X(_,x),100):f=setInterval(()=>q(S,D),100)}),e.addEventListener("touchmove",i=>{if(!u)return;const c=i.touches[0],b=c.clientX-g,j=c.clientY-h;P(t,b,j)}),e.addEventListener("touchend",()=>{u=!1,t==="left"?(m(p,{x:0,y:0}),clearInterval(a),a=null):(m(o,{x:0,y:0}),clearInterval(f),f=null)})};tt(()=>{R("left-stick","left"),R("right-stick","right")}),M.on("connect",()=>{console.log("Socket connected")}),M.on("disconnect",()=>{console.log("Socket disconnected")}),N();var L=lt(),I=k(L),G=k(I);y(I);var O=T(I,2),E=k(O),H=k(E);y(E);var $=T(E,2),J=k($);return y($),y(O),y(L),C(()=>{U(G,`Power ${(n(s)?"Off":"On")??""}`),B(H,`left: calc(50% + ${n(p).x??""}px); top: calc(50% + ${n(p).y??""}px);`),B(J,`left: calc(50% + ${n(o).x??""}px); top: calc(50% + ${n(o).y??""}px);`)}),Q("click",I,F),W(r,L),Z(d,"prerender",w),K({prerender:w})}export{ut as component};
